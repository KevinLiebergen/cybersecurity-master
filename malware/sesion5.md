# Sesion 5

Si nos llega un mensaje con phishing

en las urls cambiar . por [.], y las http por hxxp


Cambiar el user agent por móvil, Android, iPhone


Ir comentando en el readme.md

## Reglas yara

* Reglas comunitarias
* Herramienta de detección por patrones



conditions: cuantificadores, reglas lógicas, etc

`yara -r data/my_rules/lan_explorer.yar data/malware`

solo para la detección



patrones bascados en máscaras


mascarass y regex son cosas distintas


Máscaras, importante para magic numbers
```
rule hex
{
    strings:
        $my_hex_String = {E2 34 A1 ( C8 | ?? [1-5] ) 23 FB }
    condition:
        $my_hex_string

}
```

se pueden combinar elementos, lo puede codificar y lo busca, por xor...
```yara
rule TexttoYhex
{
    strings:
        $my_text_String = "text here" base64
        $my_text_String = "text here" xor(0x01-0xff)
        $my_hex_String = {E2 34 A1 ( C8 | ?? [1-5] ) 23 FB }
    condition:
        $my_hex_string and $my_text_String

}
```


freshclam *

clamscan *


clamav antivirus basado en firmas


por firmas es muy facil de bypassear

* joesandbox   cloud

* hybrid-analysis.com

* cuckoo sandbox

* packettotal.com subir pcaps

* any.run limitacion por tamaño



si un dll tiene pocos métdos es un exe ofuscado



muestra de javi segun any.run dice q esta bien y clamav dice q esta bien

